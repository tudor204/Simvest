{% extends "base.html" %}

{% block content %}
<div class="bg-gray-50 dark:bg-gray-900 min-h-screen px-6 py-8">
<div class="max-w-4xl mx-auto pb-16">
    
    <!-- HEADER -->
    <div class="mb-10">
        <div class="flex items-center gap-3 mb-3">
            <a href="{{ url_for('profile.profile') }}" class="text-gray-600 dark:text-gray-400 hover:text-simvest-blue transition">
                <i class="fa-solid fa-arrow-left"></i>
            </a>
            <h1 class="text-4xl font-bold text-black dark:text-white">ConfiguraciÃ³n de Cuenta</h1>
        </div>
        <p class="text-gray-600 dark:text-gray-400 text-lg ml-8">Personaliza tu informaciÃ³n y gestiona tu seguridad</p>
    </div>

    <div class="space-y-8">
        
        <!-- SECCIÃ“N 1: INFORMACIÃ“N BÃSICA -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-md border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="px-8 py-6 border-b border-gray-100 dark:border-gray-700 flex items-center gap-3 bg-gray-50 dark:bg-gray-700/50">
                <div class="bg-blue-100 text-simvest-blue dark:bg-blue-900/30 dark:text-blue-400 p-3 rounded-lg">
                    <i class="fa-regular fa-id-card text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold text-black dark:text-white">InformaciÃ³n BÃ¡sica</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Actualiza tu perfil pÃºblico</p>
                </div>
            </div>
            
            <div class="p-8">
                <form method="POST" action="{{ url_for('profile.edit_profile') }}">
                    
                    <!-- FILA 1: Usuario y Email -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <label for="username" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-solid fa-at text-gray-500 mr-2"></i>Nombre de Usuario
                            </label>
                            <input type="text" id="username" name="username" value="{{ user.username }}" required
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition">
                            <p class="text-xs text-gray-500 mt-1">Identificador Ãºnico en Simvest</p>
                        </div>

                        <div>
                            <label for="email" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-regular fa-envelope text-gray-500 mr-2"></i>Correo ElectrÃ³nico
                            </label>
                            <input type="email" id="email" name="email" value="{{ user.email }}" required
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition">
                            <p class="text-xs text-gray-500 mt-1">Usado para acceso y notificaciones</p>
                        </div>
                    </div>

                    <!-- FILA 2: Nombre y Apellido -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <label for="first_name" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-solid fa-user text-gray-500 mr-2"></i>Nombre
                            </label>
                            <input type="text" id="first_name" name="first_name" value="{{ user.first_name or '' }}"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition"
                                placeholder="Tu nombre">
                        </div>
                        <div>
                            <label for="last_name" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-solid fa-user text-gray-500 mr-2"></i>Apellido
                            </label>
                            <input type="text" id="last_name" name="last_name" value="{{ user.last_name or '' }}"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition"
                                placeholder="Tu apellido">
                        </div>
                    </div>

                    <!-- BIOGRAFÃA -->
                    <div class="mb-8">
                        <label for="bio" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                            <i class="fa-solid fa-pen-fancy text-gray-500 mr-2"></i>BiografÃ­a
                        </label>
                        <textarea id="bio" name="bio" rows="4"
                            class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition resize-none"
                            placeholder="CuÃ©ntanos un poco sobre ti, tu experiencia en inversiÃ³n, tus intereses...">{{ user.bio or '' }}</textarea>
                        <p class="text-xs text-gray-500 mt-2 flex justify-between">
                            <span>Visible en tu perfil pÃºblico</span>
                            <span id="bio-count">0/500</span>
                        </p>
                    </div>

                    <!-- FILA 3: Idioma y Zona Horaria -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <label for="language" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-solid fa-language text-gray-500 mr-2"></i>Idioma
                            </label>
                            <select id="language" name="language"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition">
                                <option value="es" {% if user.language == 'es' %}selected{% endif %}>ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
                                <option value="en" {% if user.language == 'en' %}selected{% endif %}>ðŸ‡ºðŸ‡¸ English</option>
                            </select>
                        </div>
                        <div>
                            <label for="timezone" class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fa-regular fa-clock text-gray-500 mr-2"></i>Zona Horaria
                            </label>
                            <select id="timezone" name="timezone"
                                class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-black dark:text-white focus:ring-2 focus:ring-simvest-blue focus:border-transparent shadow-sm transition">
                                <option value="UTC" {% if user.timezone == 'UTC' %}selected{% endif %}>UTC - Hora Universal</option>
                                <option value="America/Mexico_City" {% if user.timezone == 'America/Mexico_City' %}selected{% endif %}>ðŸ‡²ðŸ‡½ Ciudad de MÃ©xico (CDT/CST)</option>
                                <option value="America/New_York" {% if user.timezone == 'America/New_York' %}selected{% endif %}>ðŸ‡ºðŸ‡¸ New York (EDT/EST)</option>
                                <option value="America/Los_Angeles" {% if user.timezone == 'America/Los_Angeles' %}selected{% endif %}>ðŸ‡ºðŸ‡¸ Los Angeles (PDT/PST)</option>
                                <option value="America/Toronto" {% if user.timezone == 'America/Toronto' %}selected{% endif %}>ðŸ‡¨ðŸ‡¦ Toronto (EDT/EST)</option>
                                <option value="Europe/London" {% if user.timezone == 'Europe/London' %}selected{% endif %}>ðŸ‡¬ðŸ‡§ Londres (BST/GMT)</option>
                                <option value="Europe/Madrid" {% if user.timezone == 'Europe/Madrid' %}selected{% endif %}>ðŸ‡ªðŸ‡¸ Madrid (CEST/CET)</option>
                                <option value="America/Buenos_Aires" {% if user.timezone == 'America/Buenos_Aires' %}selected{% endif %}>ðŸ‡¦ðŸ‡· Buenos Aires (ART)</option>
                                </select>
                        </div>
                    </div>

                    <!-- BOTONES DE ACCIÃ“N -->
                    <div class="flex items-center justify-end gap-4 pt-6 border-t border-gray-100 dark:border-gray-700">
                        <a href="{{ url_for('profile.profile') }}" class="px-6 py-2.5 text-sm font-semibold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition">
                            Cancelar
                        </a>
                        <button type="submit" class="flex items-center gap-2 px-6 py-2.5 bg-simvest-blue hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all transform hover:scale-[1.02]">
                            <i class="fa-solid fa-check"></i> Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- SECCIÃ“N 2: PREFERENCIAS DE SEGURIDAD -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-md border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="px-8 py-6 border-b border-gray-100 dark:border-gray-700 flex items-center gap-3 bg-amber-50 dark:bg-amber-900/10">
                <div class="bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400 p-3 rounded-lg">
                    <i class="fa-solid fa-shield text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold text-black dark:text-white">Seguridad y Privacidad</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Protege tu cuenta con contraseÃ±as fuertes</p>
                </div>
            </div>
            
            <div class="p-8">
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-100 dark:border-gray-600">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400 flex items-center justify-center">
                                <i class="fa-solid fa-check-circle"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-black dark:text-white">Email Verificado</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">{{ user.email }}</p>
                            </div>
                        </div>
                        <span class="text-xs font-semibold text-green-600 dark:text-green-400 px-3 py-1 bg-green-50 dark:bg-green-900/20 rounded-full">âœ“ Activo</span>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-100 dark:border-gray-600">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-blue-100 text-simvest-blue dark:bg-blue-900/30 dark:text-blue-400 flex items-center justify-center">
                                <i class="fa-solid fa-lock"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-black dark:text-white">ContraseÃ±a</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Ãšltima vez cambiada hace 3 meses</p>
                            </div>
                        </div>
                        <button class="text-sm font-semibold text-simvest-blue hover:text-blue-700 dark:hover:text-blue-400 transition">
                            Cambiar
                        </button>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-100 dark:border-gray-600">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400 flex items-center justify-center">
                                <i class="fa-solid fa-smartphone"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-black dark:text-white">AutenticaciÃ³n de Dos Factores</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">AÃ±ade una capa extra de seguridad</p>
                            </div>
                        </div>
                        <button class="text-sm font-semibold text-gray-600 dark:text-gray-400 hover:text-simvest-blue transition">
                            Activar
                        </button>
                    </div>
                </div>

                <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-800/50 rounded-lg">
                    <div class="flex gap-3">
                        <i class="fa-solid fa-info-circle text-simvest-blue flex-shrink-0 mt-1"></i>
                        <p class="text-sm text-blue-800 dark:text-blue-300">
                            Para tu seguridad, te recomendamos cambiar tu contraseÃ±a regularmente y activar la autenticaciÃ³n de dos factores.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECCIÃ“N 3: ZONA DE PELIGRO -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-md border border-red-200 dark:border-red-900/30 overflow-hidden">
            <div class="px-8 py-6 border-b border-red-200 dark:border-red-900/30 flex items-center gap-3 bg-red-50 dark:bg-red-900/10">
                <div class="bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400 p-3 rounded-lg">
                    <i class="fa-solid fa-triangle-exclamation text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold text-black dark:text-white">Zona de Peligro</h2>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Acciones que no se pueden deshacer</p>
                </div>
            </div>
            
            <div class="p-8">
                <div class="flex items-center justify-between p-4 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-900/30">
                    <div>
                        <p class="font-semibold text-black dark:text-white">Eliminar Cuenta</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Esto eliminarÃ¡ permanentemente tu cuenta y todos tus datos</p>
                    </div>
                    <button class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all">
                        Eliminar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Contador de caracteres para biografÃ­a
    const bioTextarea = document.getElementById('bio');
    const bioCount = document.getElementById('bio-count');
    
    if (bioTextarea && bioCount) {
        bioTextarea.addEventListener('input', function() {
            bioCount.textContent = `${this.value.length}/500`;
        });
        // Inicializar contador
        bioCount.textContent = `${bioTextarea.value.length}/500`;
    }
</script>
{% endblock %}
                </form>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-md border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="px-8 py-6 border-b border-gray-100 dark:border-gray-700 flex items-center gap-3">
                <div class="bg-orange-100 text-orange-600 dark:bg-orange-900/30 dark:text-orange-400 p-2 rounded-lg">
                    <i class="fa-solid fa-shield-halved text-xl"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-800 dark:text-white">Cambiar ContraseÃ±a</h2>
            </div>

            <div class="p-8">
                <form method="POST" action="{{ url_for('profile.change_password') }}">
                    <div class="grid grid-cols-1 gap-6 max-w-2xl">
                        <div>
                            <label for="current_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                ContraseÃ±a Actual
                            </label>
                            <input type="password" id="current_password" name="current_password" required
                                class="block w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-orange-500 focus:border-orange-500 shadow-sm sm:text-sm transition">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="new_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Nueva ContraseÃ±a
                                </label>
                                <input type="password" id="new_password" name="new_password" required
                                    class="block w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-orange-500 focus:border-orange-500 shadow-sm sm:text-sm transition">
                            </div>
                            <div>
                                <label for="confirm_password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Confirmar Nueva ContraseÃ±a
                                </label>
                                <input type="password" id="confirm_password" name="confirm_password" required
                                    class="block w-full rounded-lg border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-orange-500 focus:border-orange-500 shadow-sm sm:text-sm transition">
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-end">
                        <button type="submit" class="bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:text-orange-600 dark:hover:text-orange-400 font-semibold py-2.5 px-6 rounded-lg transition duration-200 shadow-sm">
                            Actualizar ContraseÃ±a
                        </button>
                    </div>
                </form>
            </div>
        </div>

    </div>
</div>
</div>
{% endblock %}
{% endblock %}